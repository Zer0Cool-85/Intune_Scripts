<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    x:Name="MainWindow"
    Title="PC Info"
    Height="500"
    Width="800"
    WindowStartupLocation="CenterScreen"
    WindowStyle="None"
    AllowsTransparency="True"
    Background="Transparent">

    <Border CornerRadius="12" Background="#f3f3f3" BorderBrush="#d0d0d0" BorderThickness="1" SnapsToDevicePixels="True">
        <Grid>
            <!-- Drop shadow effect -->
            <Border.Effect>
                <DropShadowEffect BlurRadius="15" Opacity="0.25"/>
            </Border.Effect>

            <Grid.RowDefinitions>
                <RowDefinition Height="48"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="50"/>
            </Grid.RowDefinitions>

            <!-- Custom Title Bar -->
            <Grid Background="#ffffff" Grid.Row="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="48"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="PC Info" VerticalAlignment="Center" Margin="15,0,0,0" FontWeight="Bold" FontSize="16" Foreground="#444" FontFamily="Segoe UI"/>
                <Button x:Name="Button_Close" Grid.Column="1" Content="✕" Width="48" Height="48" Background="Transparent" BorderThickness="0"
                        Foreground="#666" FontSize="14" Cursor="Hand"
                        ToolTip="Close"/>
            </Grid>

            <!-- Main Content -->
            <ScrollViewer Grid.Row="1">
                <StackPanel Margin="20" Orientation="Vertical" Spacing="10">

                    <TextBlock Text="System Information" FontSize="20" FontWeight="SemiBold" Foreground="#333" FontFamily="Segoe UI" Margin="0,0,0,10"/>

                    <Border Background="#fff" CornerRadius="8" Padding="15" BorderBrush="#ddd" BorderThickness="1">
                        <StackPanel>
                            <TextBlock Text="Computer Name:" FontWeight="Bold" FontSize="14" Foreground="#555"/>
                            <TextBlock x:Name="Text_ComputerName" Text="Loading..." FontSize="14" Foreground="#111"/>
                        </StackPanel>
                    </Border>

                    <Border Background="#fff" CornerRadius="8" Padding="15" BorderBrush="#ddd" BorderThickness="1">
                        <StackPanel>
                            <TextBlock Text="OS Version:" FontWeight="Bold" FontSize="14" Foreground="#555"/>
                            <TextBlock x:Name="Text_OSVersion" Text="Loading..." FontSize="14" Foreground="#111"/>
                        </StackPanel>
                    </Border>

                    <Border Background="#fff" CornerRadius="8" Padding="15" BorderBrush="#ddd" BorderThickness="1">
                        <StackPanel>
                            <TextBlock Text="Memory:" FontWeight="Bold" FontSize="14" Foreground="#555"/>
                            <TextBlock x:Name="Text_Memory" Text="Loading..." FontSize="14" Foreground="#111"/>
                        </StackPanel>
                    </Border>

                </StackPanel>
            </ScrollViewer>

            <!-- Footer -->
            <Grid Grid.Row="2" Background="#fafafa">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="120"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="© 2025 My Company" VerticalAlignment="Center" Margin="10,0,0,0" Foreground="#888" FontSize="12"/>
                <Button x:Name="Button_Exit" Content="Exit" Grid.Column="1" Margin="10" Background="#0078d4" Foreground="White" BorderThickness="0" CornerRadius="6" Cursor="Hand"/>
            </Grid>
        </Grid>
    </Border>
</Window>


$WPFButton_Close.Add_Click({ $Form.Close() })
$WPFButton_Exit.Add_Click({ $Form.Close() })

# Clean up XAML safely without destroying the <Window> attributes
$inputXML = $inputXML -replace 'mc:Ignorable="d"', '' -replace 'x:N', 'N'

[void][System.Reflection.Assembly]::LoadWithPartialName('PresentationFramework')

# Load the XML
[xml]$XamlXml = $inputXML

# Create the reader from the correct variable
$reader = New-Object System.Xml.XmlNodeReader $XamlXml
try {
    $Form = [Windows.Markup.XamlReader]::Load($reader)
} catch {
    Write-Host "Unable to load Windows.Markup.XamlReader. Double-check syntax and ensure .NET is installed."
}

# Load named elements into WPF variables
$XamlXml.SelectNodes("//*[@Name]") | ForEach-Object {
    Set-Variable -Name "WPF$($_.Name)" -Value $Form.FindName($_.Name)
}
